<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FC尾島ジュニア　日程・出欠・配車管理</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <header>
        <h1 id="event-header">FC尾島ジュニア　日程・出欠・配車管理</h1>
    </header>
    
    <div class="container">
        <div class="tab">
            <button class="tablinks" onclick="FCOjima.Carpool.UI.openTab(event, 'games')" id="defaultTab">概要</button>
            <button class="tablinks" onclick="FCOjima.Carpool.UI.openTab(event, 'attendance')">出欠確認</button>
            <button class="tablinks" onclick="FCOjima.Carpool.UI.openTab(event, 'cars')">車提供</button>
            <button class="tablinks" onclick="FCOjima.Carpool.UI.openTab(event, 'assignments')">割り当て</button>
            <button class="tablinks" onclick="FCOjima.Carpool.UI.openTab(event, 'notifications')">連絡</button>
        </div>
        
        <!-- 概要タブ -->
        <div id="games" class="tabcontent">
            <h2>イベント概要</h2>
            <div id="event-summary">
                <!-- イベント情報がここに表示される -->
                <div class="loading">読み込み中...</div>
            </div>
        </div>
        
        <!-- 出欠確認タブ -->
        <div id="attendance" class="tabcontent">
            <h2>選手の出欠確認</h2>
            <div id="attendance-deadline" class="stats-summary">
                <!-- 出欠期限がここに表示される -->
            </div>
            <div id="attendance-stats" class="stats-summary">
                <!-- 出欠統計がここに表示される -->
            </div>
            <div class="table-container">
                <table id="attendance-table">
                    <thead>
                        <tr>
                            <th>選手名</th>
                            <th>学年</th>
                            <th>出欠</th>
                            <th>備考</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- データがJSで動的に生成される -->
                    </tbody>
                </table>
            </div>
            <div class="action-buttons">
                <button type="button" id="save-attendance">出欠を保存</button>
                <button type="button" id="reminder-attendance">未回答者にリマインド</button>
                <button type="button" id="add-attendee">メンバーを追加</button>
            </div>
        </div>
        
        <!-- 車の提供タブ -->
        <div id="cars" class="tabcontent">
            <h2>車の提供</h2>
            <div id="carEventInfo">
                <!-- イベント情報がここに表示される -->
            </div>
            
            <h3>車の提供登録</h3>
            <form id="carForm">
                <div class="form-group">
                    <label for="parentName">運転者:</label>
                    <div style="display:flex; gap:10px;">
                        <input type="text" id="parentName" style="flex:1;">
                        <button type="button" id="select-driver" class="secondary-button">メンバーから選ぶ</button>
                    </div>
                </div>
                <div class="form-group">
                    <label for="canDrive">車の提供:</label>
                    <select id="canDrive">
                        <option value="both">行き帰り可能</option>
                        <option value="no">不可</option>
                        <option value="to">行きのみ可能</option>
                        <option value="from">帰りのみ可能</option>
                    </select>
                </div>
                <div id="carDetails">
                    <h4>乗車可能人数</h4>
                    <div class="seat-inputs">
                        <div class="form-group">
                            <label for="frontSeat">助手席:</label>
                            <input type="number" id="frontSeat" min="0" max="1" value="1">
                        </div>
                        <div class="form-group">
                            <label for="middleSeat">中列:</label>
                            <input type="number" id="middleSeat" min="0" max="3" value="3">
                        </div>
                        <div class="form-group">
                            <label for="backSeat">後列:</label>
                            <input type="number" id="backSeat" min="0" max="3" value="0">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="notes">備考:</label>
                        <input type="text" id="notes" placeholder="部員外の兄弟児等を乗せたい場合は記入してください。その他特記事項あれば。">
                    </div>
                </div>
                <div class="action-buttons">
                    <button type="button" id="register-car">登録</button>
                </div>
            </form>
            
            <h3>登録済み車両</h3>
            <div id="car-stats" class="stats-summary">
                <!-- 車両統計がここに表示される -->
            </div>
            <div class="table-container">
                <table id="registeredCars">
                    <thead>
                        <tr>
                            <th>運転者</th>
                            <th>提供</th>
                            <th>助手席</th>
                            <th>中列</th>
                            <th>後列</th>
                            <th>合計</th>
                            <th>備考</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- 登録データがJSで動的に生成される -->
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- 乗車割り当てタブ -->
        <div id="assignments" class="tabcontent">
            <h2>乗車割り当て</h2>
            <div id="assignmentEventInfo">
                <!-- イベント情報がここに表示される -->
            </div>
            
            <div class="assignment-container">
                <!-- 左側：車両座席表示エリア -->
                <div class="car-seats-container">
                    <h3>車両座席配置</h3>
                    <div class="cars-scroll-area" id="cars-container">
                        <!-- 車両情報がJSで動的に生成される -->
                    </div>
                </div>
                
                <!-- 右側：メンバーリストエリア -->
                <div class="members-assignment-container">
                    <h3>配置可能なメンバー</h3>
                    <div class="members-scroll-area" id="members-container">
                        <!-- メンバーリストがJSで動的に生成される -->
                    </div>
                </div>
            </div>
            
            <div class="action-buttons">
                <button id="generate-random">ランダム配置</button>
                <button id="save-assignments">保存</button>
                <button id="share-assignments">LINEで共有</button>
            </div>
        </div>
        
        <!-- 連絡事項タブ -->
        <div id="notifications" class="tabcontent">
            <h2>連絡事項</h2>
            <div id="notificationsList">
                <!-- 連絡事項がJSで動的に生成される -->
            </div>
            
            <h3>新規連絡事項</h3>
            <form id="notificationForm">
                <div class="form-group">
                    <label for="notificationText">内容:</label>
                    <textarea id="notificationText" rows="4"></textarea>
                </div>
                <div class="action-buttons">
                    <button type="button" id="send-notification">送信</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- グローバルナビゲーション - 画面下部に常に表示 -->
    <div class="global-navigation">
        <button id="back-to-hub">HUBに戻る</button>
        <button id="share-event-button" class="share-button">LINEで共有</button>
    </div>
    
    <!-- メンバー選択モーダル -->
    <div id="member-select-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>メンバーを選択</h2>
            <div id="member-select-list" class="select-list">
                <!-- メンバーリストがJSで動的に生成される -->
            </div>
        </div>
    </div>
    
    <!-- 運転者選択モーダル -->
    <div id="driver-select-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>運転者を選択</h2>
            <div id="driver-select-list" class="select-list">
                <!-- 保護者リストがJSで動的に生成される -->
            </div>
        </div>
    </div>
    
    <!-- 座席編集モーダル -->
    <div id="seat-edit-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>座席の編集</h2>
            <form id="seat-edit-form">
                <div class="form-group">
                    <label for="seat-person">乗車メンバー:</label>
                    <input type="text" id="seat-person">
                </div>
                <div class="form-actions">
                    <button type="submit">保存</button>
                    <button type="button" id="cancel-seat-edit">キャンセル</button>
                    <button type="button" id="clear-seat" class="delete-button">座席をクリア</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- 共通モジュール -->
    <script src="js/common/global.js"></script>
    <script src="js/common/utils.js"></script>
    <script src="js/common/storage.js"></script>
    <script src="js/common/ui.js"></script>
    
    <!-- 配車管理ページモジュール -->
    <script src="js/carpool/main.js"></script>
    <script src="js/carpool/overview.js"></script>
    <script src="js/carpool/attendance.js"></script>
    <script src="js/carpool/carprovision.js"></script>
    <script src="js/carpool/assignment.js"></script>
    <script src="js/carpool/notifications.js"></script>
    
    <script>
        // DOMコンテンツ読み込み時
        document.addEventListener('DOMContentLoaded', function() {
            // デフォルトタブを開く
            document.getElementById('defaultTab').click();
            
            // HUBに戻るボタンの設定
            document.getElementById('back-to-hub').addEventListener('click', function() {
                FCOjima.Carpool.Overview.goToMainPage();
            });
            
            // イベント共有ボタンの設定
            document.getElementById('share-event-button').addEventListener('click', function() {
                FCOjima.Carpool.Overview.shareEventViaLINE();
            });
        });
    </script>
</body>
</html>